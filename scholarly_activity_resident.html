<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scholarly Activity - Resident</title>

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" />
    <link rel="stylesheet" type="text/css"
        href="https://cdn.jsdelivr.net/npm/@mdi/font@3.x/css/materialdesignicons.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Material+Icons" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/vuetify@2.0.10/dist/vuetify.min.css" />
    <link rel="stylesheet" type="text/css"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css" />
    
    <script src="https://cdn.jsdelivr.net/npm/babel-regenerator-runtime@6.5.0/runtime.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/babel-polyfill/dist/polyfill.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.0.10/dist/vuetify.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
    <script src="https://unpkg.com/vue-chartjs@3.4.0/dist/vue-chartjs.js"></script>
</head>
<body>
    <!-- header -->
    <div class="bg-stone-100 border-gray-200 px-2 sm:px-4 py-2.5 rounded ">
        <div class="container flex flex-wrap items-center justify-between mx-auto" style="width: 100%; overflow: hidden;">
            <img src="images/SingHealth_Logo.png" class="mr-3 sm:h-15 ml-3 mt-2 mb-2"
                style="height: 80px ; width: 100px;" alt="Flowbite Logo" />

            <div class="flex md:order-2">
                <a href="homepage.html" style="margin-right: 10px;">
                    <iconify-icon icon="ic:round-home" style="color: #ff6b00;" width="40" height="40"></iconify-icon>
                </a>
                <a>
                    <iconify-icon icon="healthicons:ui-user-profile" style="color: #ff6b00;" width="40" height="40">
                    </iconify-icon>
                </a>

                <button data-collapse-toggle="navbar-sticky" type="button"
                    class="inline-flex items-center p-2 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 "
                    aria-controls="navbar-cta" aria-expanded="false">
                    <span class="sr-only">Open main menu</span>
                    <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                            clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Navbar -->
    <nav class="bg-white">
        <div class="items-center justify-between hidden w-full md:flex md:width-auto  md:order-1" id="navbar-sticky" style="width: 100%; overflow: hidden;">
            <ul class="md:divide-x md:divide-slate-200 flex flex-col p-2 border border-gray-100 rounded-lg bg-gray-50 md:flex-row  md:mt-0 md:text-sm md:font-medium md:border-0 md:bg-white">
                <li>
                    <a href="#"
                        class="lg:text-sm md:text-xs mr-2 ml-4 lg:ml-10 block py-2 pl-3 pr-2 text-white bg-orange-500 rounded md:bg-transparent md:text-orange-500 md:p-0 dark:text-white"
                        aria-current="page">Homepage</a>
                </li>
                <li>
                    <a href="../FYP-GoodHealth/tab_pages/personal_details.html"
                        class="lg:text-sm md:text-xs ml-5 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">
                        Resident Profile</a>
                </li>
                <li>
                    <a href="#"
                        class="lg:text-sm md:text-xs ml-5 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">
                        History</a>
                </li>
                <li>
                    <a href="#"
                        class="lg:text-sm md:text-xs ml-5 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">
                        Involvement</a>
                </li>
                <li>
                    <a href="#"
                        class="lg:text-sm md:text-xs  ml-5 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">
                        Grants</a>
                </li>
                <li>
                    <a href="#"
                        class="lg:text-sm md:text-xs  ml-5 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">
                        Publications</a>
                </li>
                <li>
                    <a href="#"
                        class="lg:text-sm md:text-xs  ml-6 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">Presentations</a>
                </li>
                <li>
                    <a href="#"
                        class="lg:text-sm md:text-xs  ml-6 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">
                        Awards</a>
                </li>
                <li>
                    <a href="#"
                        class="lg:text-sm md:text-xs  ml-6 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">Projects</a>
                </li>
            </ul>
        </div>
    </nav>
    <!-- Orange Divider -->
    <div class='row' style='height: 8px; background-color: #ff6b00;'></div>
    <div class="container mx-auto pt-4">
        <!-- <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="grid-first-name">
            MCR_No:
        </label>
        <input v-model="mcr_no" 
            class="appearance-none block w-full bg-gray-200 text-gray-700 border border-red-500 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white" 
            id="grid-first-name" type="text" placeholder="Input MCR No. Here">
        <br>
        <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="grid-first-name">
            Year:
        </label>
        <input v-model="year" 
            class="appearance-none block w-full bg-gray-200 text-gray-700 border border-red-500 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white" 
            id="grid-first-name" type="text" placeholder="Input Year Here">
        <br>
        <button @click="getDutyHourLogData()" class="bg-[#ea580c] hover:bg-[#292524] text-white font-bold py-2 px-4 rounded">
            Get Resident's Info
        </button>
        <br>
        <button @click="reset()" class="bg-[#ea580c] hover:bg-[#292524] text-white font-bold py-2 px-4 rounded ">
            Reset
        </button> -->

        <div id="app">
            <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="grid-first-name">
                MCR_No:
            </label>
            <input v-model="mcr_no" 
                class="appearance-none block w-full bg-gray-200 text-gray-700 border border-red-500 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white" 
                id="grid-first-name" type="text" placeholder="Input MCR No. Here">
            <br>
            <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="grid-first-name">
                Year:
            </label>
            <input v-model="year" 
                class="appearance-none block w-full bg-gray-200 text-gray-700 border border-red-500 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white" 
                id="grid-first-name" type="text" placeholder="Input Year Here">
            <br>
            <button @click="getData()" class="bg-[#ea580c] hover:bg-[#292524] text-white font-bold py-2 px-4 rounded">
                Get Resident's Info
            </button>
            <br>
            <button @click="reset()" class="bg-[#ea580c] hover:bg-[#292524] text-white font-bold py-2 px-4 rounded ">
                Reset
            </button>
            <v-row dense>
                <v-col cols="sm">
                    <v-card class="pa-2" outlined tile raised>
                        <my-donut-chart v-if="loaded1 && loaded2" :donut-data="ChartConfig" :chart-options="options"></my-donut-chart>
                    </v-card>
                </v-col>
            </v-row>
        </div>

    </div>

<script>
    Vue.component('my-donut-chart', {
            extends: VueChartJs.Doughnut,
            props: ['donutData', 'chartOptions'],
            mounted() {
            this.renderChart(this.donutData, this.chartOptions);
            },
        }, {
            responsive: true,
            maintainAspectRatio: false
        })

    new Vue({
        el: "#app",
        vuetify: new Vuetify(),
        data() {
        return {
            year: null,
            mcr_no: null,
            loaded1: false,
            loaded2: false,
            combinedData: [],
            ChartConfig: {
            // labels: ["Completed", "Not Completed"],
            datasets: [
                {
                data: [],
                backgroundColor: ['#ff6b00','#ffedd5'],
                borderColor: 'rgba(136,136,136,0.5)',
                label: "Compliant"
                }
            ]
            },
            options: {
            responsive: true,
            maintainAspectRatio: false,
            title: {
                display: true,
                text: 'Scholarly Activity (Resident)'
            },
            tooltips: {
                mode: 'index',
                intersect: false,
            },
            hover: {
                mode: 'nearest',
                intersect: true
            },
            scales: {
            }
            },
        }
        },
        mounted: function () {
            this.loaded1 = false
            this.loaded2 = false
            // this.getPublicationsData();
            // this.getPresentationsData();
            // this.getChartData();
            },
        methods: {
            reset: function (){
                this.ChartConfig.datasets[0].data.length = 0
                this.combinedData.length = 0
                this.loaded1 = false
                this.loaded2 = false
                },
            getPublicationsData: async function () {

                this.status = "getting data...";

                await axios.get("http://localhost:5010/publication/" + this.mcr_no + "/" + this.year).then((response) => {
                console.log("This is responseData1")
                console.log(response.data)
                // this.getChartData(response.data);
                this.combinedData.push(response.data);
                this.loaded1 = true
                })
                .catch(function (error) {
                    console.log(error);
                });
            },
            getPresentationsData: async function () {
                this.status = "getting data...";

                await axios.get("http://localhost:5010/presentation/" + this.mcr_no + "/" + this.year).then((response) => {
                console.log("This is responseData2")
                console.log(response.data)
                // this.getChartData(response.data);
                this.combinedData.push(response.data);
                this.loaded2 = true
                })
                .catch(function (error) {
                    console.log(error);
                });
            },
            getData: function(){
                this.getPresentationsData();
                this.getPublicationsData();
                console.log(this.combinedData);
                this.getChartData(this.combinedData);
            },

            getChartData: async function (combinedData) {
                console.log("This is combinedData")
                // console.log(this.combinedData);
                // console.log(chartData.data[0]['End_Date']);

                // counterCompletionQI = 0
                // numOfEntries = 0
                // percentageCompleted = 0
                // percentageNotCompleted = 0

                // for (var i = 0; i < chartData.data.length; i++) {
                //     numOfEntries++
                //     if (chartData.data[i]['End_Date'] != 'Ongoing') {
                //         counterCompletionQI++
                //     }
                // }

                // console.log(counterCompletionQI)
                // console.log(numOfEntries)

                // percentageCompleted = counterCompletionQI/numOfEntries
                // percentageNotCompleted = 1 - percentageCompleted

                // this.ChartConfig.datasets[0].data.push(percentageCompleted)
                // this.ChartConfig.datasets[0].data.push(percentageNotCompleted)

            }
        }
    });
</script>
</body>
</html>