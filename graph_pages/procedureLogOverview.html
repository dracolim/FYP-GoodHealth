<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- INSTALLATIONS -->
    <!-- flowbite -->
    <link href="../node_modules/flowbite/dist/flowbite.min.css" rel="stylesheet" />
    <!-- Tailwind -->
    <link rel="stylesheet" href="../css/tailwind.css">
    <!-- ICONIFY -->
    <script src="../css/iconify-icon.min.js"></script>
    <!-- <script src="https://code.iconify.design/iconify-icon/1.0.2/iconify-icon.min.js"></script> -->
    <!-- LOCAL VUE 2.7.14 -->
    <script src="../node_modules/vue/dist/vue.js"></script>
    <!-- LOCAL Tabulator  -->
    <link href="../node_modules/tabulator-tables/dist/css/tabulator_semanticui.css" rel="stylesheet">
    <script type="text/javascript" src="../node_modules/tabulator-tables/dist/js/tabulator.js"></script>
    <!-- ExcelJS -->
    <script src="../node_modules/exceljs/dist/exceljs.min.js"></script>
    <script src="../node_modules/xlsx/dist/xlsx.full.min.js"></script>
    <!-- LOCAL Axios -->
    <script src="../node_modules/axios/dist/axios.min.js"></script>
    <!-- Local ChartJS -->
    <!-- <script src="../node_modules/chart.js/dist/chart.js"></script> -->
    <script src="../node_modules/Chart.js/dist/Chart.min.js"></script>
    <!-- Vue-Chartjs -->
    <script src="../node_modules/vue-chartjs/dist/vue-chartjs.js"></script>
    <!-- Vuetify -->
    <script src="../node_modules/vuetify/dist/vuetify.min.js"></script>
   

    <!-- Testing Mon Method -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/babel-regenerator-runtime@6.5.0/runtime.js"></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/babel-polyfill/dist/polyfill.min.js"></script> -->
    <!-- I need these three, thanks yinyao -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/vuetify@2.0.10/dist/vuetify.min.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script> -->
    <!-- <script src="https://unpkg.com/vue-chartjs@3.4.0/dist/vue-chartjs.js"></script> -->

    <title>SingHealth</title>
</head>

<body>

    <div id="main-container">
        
        <!-- header -->
        <div class="bg-stone-100 border-gray-200 px-2 sm:px-4 py-2.5 rounded ">
            <div class="container flex flex-wrap items-center justify-between mx-auto" style="width: 100%; overflow: hidden;">
                <a href="../homepage.html">
                    <img src="../images/SingHealth_Logo.png" class="mr-3 sm:h-15 ml-3 mt-2 mb-2"
                        style="height: 80px; width: 100px;" alt="Flowbite Logo" />
                </a>

                <div class="flex md:order-2">
                    <a href="../homepage.html" style="margin-right: 10px;">
                        <iconify-icon icon="ic:round-home" style="color: #ff6b00;" width="40" height="40">
                        </iconify-icon>
                    </a>


                    <button data-collapse-toggle="navbar-sticky" type="button"
                        class="inline-flex items-center p-2 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 "
                        aria-controls="navbar-cta" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20"
                            xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd"
                                d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                                clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Navbar -->
        <nav class="bg-white">
            <div class="items-center justify-between hidden w-full md:flex md:width-auto  md:order-1" id="navbar-sticky" style="width: 100%; overflow: hidden;">
                <ul class="md:divide-x md:divide-slate-200 flex flex-col p-2 border border-gray-100 rounded-lg bg-gray-50 md:flex-row  md:mt-0 md:text-sm md:font-medium md:border-0 md:bg-white">
                    <li>
                        <a href="#"
                            class="lg:text-sm md:text-xs mr-2 ml-4 lg:ml-10 block py-2 pl-3 pr-2 text-white bg-orange-500 rounded md:bg-transparent md:text-orange-500 md:p-0 dark:text-white"
                            aria-current="page">Resident Profiles</a>
                    </li>
                    <li>
                        <a href="#"
                            class="lg:text-sm md:text-xs ml-5 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">
                            History</a>
                    </li>
                    <li>
                        <a href="#"
                            class="lg:text-sm md:text-xs ml-5 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">
                            Involvement</a>
                    </li>
                    <li>
                        <a href="#"
                            class="lg:text-sm md:text-xs  ml-5 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">
                            Grants</a>
                    </li>
                    <li>
                        <a href="#"
                            class="lg:text-sm md:text-xs  ml-5 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">
                            Publications</a>
                    </li>
                    <li>
                        <a href="#"
                            class="lg:text-sm md:text-xs  ml-6 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">Presentations</a>
                    </li>
                    <li>
                        <a href="#"
                            class="lg:text-sm md:text-xs  ml-6 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">
                            Awards</a>
                    </li>
                    <li>
                        <a href="#"
                            class="lg:text-sm md:text-xs  ml-6 mr-4 block py-2 pl-3 pr-4 text-gray-700 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-orange-500 md:p-0">Projects</a>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- Orange Divider -->
        <div class='row' style='height: 8px; background-color: #ff6b00;'></div>

        <!-- Graph Goes Here -->
        <div class="container mx-auto pt-4" >

            <div id="app">

                <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="grid-first-name">
                    Programme Name:
                </label>

                <input v-model="programme" class="appearance-none block w-full bg-gray-200 text-gray-700 border border-red-500 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white" id="grid-first-name" type="text" placeholder="Input Programme Name Here">

                <button @click="getProcedureLogData()" class="bg-[#ea580c] hover:bg-[#292524] text-white font-bold py-2 px-4 rounded">
                    Get Programme's Info
                </button> 

                <v-row dense>
                  <v-col cols="sm">
                    <v-card class="pa-2" outlined tile raised>
                      <my-bar-chart v-if="loaded" :bar-data="ChartConfig" :chart-options="options"></my-bar-chart>
                    </v-card>
                  </v-col>
                </v-row>

            </div>

        </div>

    </div>

    <!--- JAVASCRIPT -->
    <script>

        Vue.component('my-bar-chart', {
            extends: VueChartJs.HorizontalBar,
            props: ['barData', 'chartOptions'],
            mounted() {
            this.renderChart(this.barData, this.chartOptions);
            },
        }, {
            responsive: true,
            maintainAspectRatio: false
        })

        new Vue({
            el: "#app",
            vuetify: new Vuetify(),
            data() {
                return {
                loaded: false,
                ChartConfig: {
                labels: ["Jan-Jun", "Jul-Dec"],
                datasets: [
                    {
                    data: [],
                    backgroundColor: '#ff6b00',
                    borderColor: 'rgba(136,136,136,0.5)',
                    label: "Compliance Level (%)"
                    }
                ]
                },
                options: {
                responsive: true,
                maintainAspectRatio: false,
                title: {
                    display: true,
                    text: 'Procedure Log (Resident)'
                },
                tooltips: {
                    mode: 'index',
                    intersect: false,
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                scales: {
                    xAxes: [{
                    ticks : {
                    max : 100,    
                    min : 0
                    },
                    display: true,
                    categoryPercentage: 0.5,
                    scaleLabel: {
                        display: true,
                        labelString: 'Percentage of Compliance'
                    }
                    }],
                    yAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                        labelString: 'Procedure Name'
                        
                    }
                    }]
                }
                },
            }
            },
            mounted: function () {
                this.loaded = false
                },
            methods: {
                getProcedureLogData: async function () {

                    this.status = "getting data...";

                    await axios.get("http://localhost:5011/procedure_log_data").then((response) => {
                    // console.log("This is responseData")
                    // console.log(response.data)
                
                    this.getChartData(response);
                    this.loaded = false
                    this.loaded = true
                    })
                    .catch(function (error) {
                        console.log(error);
                    });
                },
                getChartData: function (chartData) {
                    // console.log("This is chartData")
                    // console.log(chartData);
                    let array_of_logs = chartData.data.data

                    let gastro_array = []
                    let renal_array = []
                    let internal_array = []

                    // go through each and every procedure log
                    // split them into 3 arrays (gastro, renal and internal)
                    for (let i = 0; i < array_of_logs.length; i++) {
                        
                        if (array_of_logs[i]['Programme'] == "Gastroenterology") {
                            gastro_array.push(array_of_logs[i])
                        }

                        else if (array_of_logs[i]['Programme'] == "Renal Medicine") {
                            renal_array.push(array_of_logs[i])
                        }

                        else if (array_of_logs[i]['Programme'] == "Internal Medicine") {
                            internal_array.push(array_of_logs[i])
                        }

                    }

                    // if user chose Gastroenterology 
                    if (this.programme == "Gastroenterology") {

                        console.log("reached here")
                        const Gastro = ["Gastroscopy (OGD)", "Gastroscopy (OGD) with biopsy", "Gastroscopy (OGD) with non-variceal hemostasis; not actively bleeding","Gastroscopy (OGD) with non-variceal hemostasis; actively bleeding", "Colonoscopy with non-variceal hemostasis; not actively bleeding", "Colonoscopy with non-variceal hemostasis; actively bleeding","Colonoscopy", "Colonoscopy with biopsy", "Colonoscopy with polypectomy","Abdominal paracentesis", "Capsule endoscopy", "Percutaneous Endoscopic Gastrostomy (PEG)","Gastroscopy with variceal hemostasis; active bleeding", "Gastroscopy with variceal hemostasis; not actively bleeding", "Gastroscopy with variceal ligation; elective eradication","Liver biopsy", "Esophageal dilatation", "Luminal Stenting","Endoscopic mucosal resection (EMR) / Endoscopic submucosal dissection (ESD)", "Endoscopic Retrograde and Cholangiocpancreatography (ERCP)", "Endoscopic ultrasound", "Esophageal motility / pH studies"]
                        this.ChartConfig.labels = Gastro
                        this.options.title.text = "Procedure Log (Gastro Programme)"

                        nonCompliantResidentsGastro = []

                        GastroOGDPlusGastroOGDWithBiopsy = []
                        TotalDoneGastroOGDPlusGastroOGDWithBiopsy = 0
                        CountGastroOGDPlusGastroOGDWithBiopsy = 0
                        NumComplianceGastroOGDPlusGastroOGDWithBiopsy = 0
                
                        GastroOGDPlusColon = []
                        TotalDoneGastroOGDPlusColon = 0
                        CountGastroOGDPlusColon = 0
                        NumComplianceGastroOGDPlusColon = 0
                        GastroOGDPlusColonAdditionalReqNum = 0

                        ColonoscopyPlusColonoscopyWithBiopsy = []
                        TotalDoneColonoscopyPlusColonoscopyWithBiopsy = 0
                        CountColonoscopyPlusColonoscopyWithBiopsy = 0
                        NumComplianceColonoscopyPlusColonoscopyWithBiopsy = 0

                        ColonoscopyWithPolypectomy = []
                        TotalDoneColonoscopyWithPolypectomy = 0
                        CountColonoscopyWithPolypectomy = 0
                        NumComplianceColonoscopyWithPolypectomy = 0

                        AbdominalParacentesis = []
                        TotalDoneAbdominalParacentesis = 0
                        CountAbdominalParacentesis = 0
                        NumComplianceAbdominalParacentesis = 0

                        CapsuleEndoscopy = []
                        TotalDoneCapsuleEndoscopy = 0
                        CountCapsuleEndoscopy = 0
                        NumComplianceCapsuleEndoscopy = 0

                        Peg = []
                        TotalDonePeg = 0
                        CountPeg = 0
                        NumCompliancePeg = 0

                        GastroVaricealHemoPlusLigation = []
                        TotalDoneGastroVaricealHemoPlusLigation = 0
                        CountGastroVaricealHemoPlusLigation = 0
                        NumComplianceGastroVaricealHemoPlusLigation = 0
                        GastroVaricealHemoPlusLigationAdditionalReqNum = 0

                        LiverBiopsy = []
                        TotalDoneLiverBiopsy = 0
                        CountLiverBiopsy = 0
                        NumComplianceLiverBiopsy = 0

                        EsophagealDilatationPlusLuminalStenting = []
                        TotalDoneEsophagealDilatationPlusLuminalStenting = 0
                        CountEsophagealDilatationPlusLuminalStenting = 0
                        NumComplianceEsophagealDilatationPlusLuminalStenting = 0

                        EmrPlusEsd = []
                        TotalDoneEmrPlusEsd = 0
                        CountEmrPlusEsd = 0
                        NumComplianceEmrPlusEsd = 0

                        Ercp = []
                        TotalDoneErcp = 0
                        CountErcp = 0
                        NumComplianceErcp = 0

                        EndoscopicUltrasound = []
                        TotalDoneEndoscopicUltrasound = 0
                        CountEndoscopicUltrasound = 0
                        NumComplianceEndoscopicUltrasound = 0

                        EsophagealMotilityPlusPh = []
                        TotalDoneEsophagealMotilityPlusPh = 0
                        CountEsophagealMotilityPlusPh = 0
                        NumComplianceEsophagealMotilityPlusPh = 0

                        const groups = []

                        // go through each Gastro log
                        for (let j = 0; j < gastro_array.length; j++) {

                            gastro_array[j] //each gastro log
                            let procedure_name = gastro_array[j]['Procedure_Name'] // each gastro log's procedure name
                            // if name matches, push into respective procedure array
                            if (procedure_name == Gastro[0] || procedure_name == Gastro[1]) {
                                GastroOGDPlusGastroOGDWithBiopsy.push(gastro_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Gastro[2] || procedure_name == Gastro[3] || procedure_name == Gastro[4] || procedure_name == Gastro[5]) {
                                GastroOGDPlusColon.push(gastro_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Gastro[6] || procedure_name == Gastro[7]) {
                                ColonoscopyPlusColonoscopyWithBiopsy.push(gastro_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Gastro[8]) {
                                ColonoscopyWithPolypectomy.push(gastro_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Gastro[9]) {
                                AbdominalParacentesis.push(gastro_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Gastro[10]) {
                                CapsuleEndoscopy.push(gastro_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Gastro[11]) {
                                Peg.push(gastro_array[j])
                            }

                            else if (procedure_name == Gastro[12] || procedure_name == Gastro[13] || procedure_name == Gastro[14]) {
                                GastroVaricealHemoPlusLigation.push(gastro_array[j])
                            }

                            else if (procedure_name == Gastro[15]) {
                                LiverBiopsy.push(gastro_array[j])
                            }

                            else if (procedure_name == Gastro[16] || procedure_name == Gastro[17]) {
                                EsophagealDilatationPlusLuminalStenting.push(gastro_array[j])
                            }

                            else if (procedure_name == Gastro[18]) {
                                EmrPlusEsd.push(gastro_array[j])
                            }

                            else if (procedure_name == Gastro[19]) {
                                Ercp.push(gastro_array[j])
                            }

                            else if (procedure_name == Gastro[20]) {
                                EndoscopicUltrasound.push(gastro_array[j])
                            }
                            
                            else if (procedure_name == Gastro[21]) {
                                EsophagealMotilityPlusPh.push(gastro_array[j])
                            }

                        }
                        
                        // grouped1 contains GastroOGD plus GastroOGDWithBiopsy records, split into different residents
                        let grouped1 = {};
                        for (let i=0; i<GastroOGDPlusGastroOGDWithBiopsy.length; i++) {
                            let p = GastroOGDPlusGastroOGDWithBiopsy[i]['MCR_No'];
                            if (!grouped1[p]) { grouped1[p] = []; }
                            grouped1[p].push(GastroOGDPlusGastroOGDWithBiopsy[i]);
                        }

                        CountGastroOGDPlusGastroOGDWithBiopsy = Object.keys(grouped1).length

                        // for each resident in grouped1,
                        for (const key in grouped1) {
                            const value = grouped1[key] // the [?]array containing the resident's procedure info

                            TotalDoneGastroOGDPlusGastroOGDWithBiopsy = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneGastroOGDPlusGastroOGDWithBiopsy = TotalDoneGastroOGDPlusGastroOGDWithBiopsy + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneGastroOGDPlusGastroOGDWithBiopsy >= 300) { // if comply
                                    NumComplianceGastroOGDPlusGastroOGDWithBiopsy++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceGastroOGDPlusGastroOGDWithBiopsy != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceGastroOGDPlusGastroOGDWithBiopsy/CountGastroOGDPlusGastroOGDWithBiopsy*100).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((NumComplianceGastroOGDPlusGastroOGDWithBiopsy/CountGastroOGDPlusGastroOGDWithBiopsy*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }
                        

                        // grouped2 contains GastroOGD plus Colon records, split into different residents
                        let grouped2 = {};
                        for (let i=0; i<GastroOGDPlusColon.length; i++) {
                            let p = GastroOGDPlusColon[i]['MCR_No'];
                            if (!grouped2[p]) { grouped2[p] = []; }
                            grouped2[p].push(GastroOGDPlusColon[i]);
                        }

                        CountGastroOGDPlusColon = Object.keys(grouped2).length

                        // for each resident in grouped2,
                        for (const key in grouped2) {
                            const value = grouped2[key] // the [?]array containing the resident's procedure info
                            console.log(value)

                            TotalDoneGastroOGDPlusColon = 0 //continue from below here
                            GastroOGDPlusColonAdditionalReqNum = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneGastroOGDPlusColon = TotalDoneGastroOGDPlusColon + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            for (let i = 0; i < value.length; i++) { // preparation for checking additional requirement
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                if (value[i]['Procedure_Name'] == "Gastroscopy (OGD) with non-variceal hemostasis; actively bleeding" || value[i]['Procedure_Name'] == "Colonoscopy with non-variceal hemostasis; actively bleeding") {
                                    GastroOGDPlusColonAdditionalReqNum = GastroOGDPlusColonAdditionalReqNum + parseInt(procedure_obj['Performed'])
                                }
                            }

                            if (TotalDoneGastroOGDPlusColon >= 20 && GastroOGDPlusColonAdditionalReqNum >= 10) { // if comply
                                    console.log("triggered here")
                                    NumComplianceGastroOGDPlusColon++
                            }

                            else {
                                nonCompliantResidentsGastro.push(value)
                            }

                        }      
                        
                        if (NumComplianceGastroOGDPlusColon != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceGastroOGDPlusColon/CountGastroOGDPlusColon*100).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((NumComplianceGastroOGDPlusColon/CountGastroOGDPlusColon*100).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((NumComplianceGastroOGDPlusColon/CountGastroOGDPlusColon*100).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((NumComplianceGastroOGDPlusColon/CountGastroOGDPlusColon*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }
                        

                        // grouped3 contains Colonoscopy plus ColonoscopyWithBiopsy records, split into different residents
                        let grouped3 = {};
                        for (let i=0; i<ColonoscopyPlusColonoscopyWithBiopsy.length; i++) {
                            let p = ColonoscopyPlusColonoscopyWithBiopsy[i]['MCR_No'];
                            if (!grouped3[p]) { grouped3[p] = []; }
                            grouped3[p].push(ColonoscopyPlusColonoscopyWithBiopsy[i]);
                        }

                        CountColonoscopyPlusColonoscopyWithBiopsy = Object.keys(grouped3).length

                        // for each resident in grouped3,
                        for (const key in grouped3) {
                            const value = grouped3[key] // the [?]array containing the resident's procedure info

                            TotalDoneColonoscopyPlusColonoscopyWithBiopsy = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneColonoscopyPlusColonoscopyWithBiopsy = TotalDoneColonoscopyPlusColonoscopyWithBiopsy + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneColonoscopyPlusColonoscopyWithBiopsy >= 180) { // if comply
                                NumComplianceColonoscopyPlusColonoscopyWithBiopsy++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceColonoscopyPlusColonoscopyWithBiopsy != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceColonoscopyPlusColonoscopyWithBiopsy/CountColonoscopyPlusColonoscopyWithBiopsy*100).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((NumComplianceColonoscopyPlusColonoscopyWithBiopsy/CountColonoscopyPlusColonoscopyWithBiopsy*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped4 contains Colonoscopy with Polypectomy records, split into different residents
                        let grouped4 = {};
                        for (let i=0; i<ColonoscopyWithPolypectomy.length; i++) {
                            let p = ColonoscopyWithPolypectomy[i]['MCR_No'];
                            if (!grouped4[p]) { grouped4[p] = []; }
                            grouped4[p].push(ColonoscopyWithPolypectomy[i]);
                        }

                        CountColonoscopyWithPolypectomy = Object.keys(grouped4).length

                        // for each resident in grouped4,
                        for (const key in grouped4) {
                            const value = grouped4[key] // the [?]array containing the resident's procedure info

                            TotalDoneColonoscopyWithPolypectomy = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneColonoscopyWithPolypectomy = TotalDoneColonoscopyWithPolypectomy + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneColonoscopyWithPolypectomy >= 20) { // if comply
                                NumComplianceColonoscopyWithPolypectomy++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceColonoscopyWithPolypectomy != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceColonoscopyWithPolypectomy/CountColonoscopyWithPolypectomy*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped5 contains Abdominal Paracentesis records, split into different residents
                        let grouped5 = {};
                        for (let i=0; i<AbdominalParacentesis.length; i++) {
                            let p = AbdominalParacentesis[i]['MCR_No'];
                            if (!grouped5[p]) { grouped5[p] = []; }
                            grouped5[p].push(AbdominalParacentesis[i]);
                        }

                        CountAbdominalParacentesis = Object.keys(grouped5).length

                        // for each resident in grouped5,
                        for (const key in grouped5) {
                            const value = grouped5[key] // the [?]array containing the resident's procedure info

                            TotalDoneAbdominalParacentesis = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneAbdominalParacentesis = TotalDoneAbdominalParacentesis + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneAbdominalParacentesis >= 10) { // if comply
                                NumComplianceAbdominalParacentesis++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceAbdominalParacentesis != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceAbdominalParacentesis/CountAbdominalParacentesis*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped6 contains Capsule Endoscopy records, split into different residents
                        let grouped6 = {};
                        for (let i=0; i<CapsuleEndoscopy.length; i++) {
                            let p = CapsuleEndoscopy[i]['MCR_No'];
                            if (!grouped6[p]) { grouped6[p] = []; }
                            grouped6[p].push(CapsuleEndoscopy[i]);
                        }

                        CountCapsuleEndoscopy = Object.keys(grouped6).length

                        // for each resident in grouped6,
                        for (const key in grouped6) {
                            const value = grouped6[key] // the [?]array containing the resident's procedure info

                            TotalDoneCapsuleEndoscopy = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneCapsuleEndoscopy = TotalDoneCapsuleEndoscopy + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneCapsuleEndoscopy >= 10) { // if comply
                                NumComplianceCapsuleEndoscopy++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceCapsuleEndoscopy != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceCapsuleEndoscopy/CountCapsuleEndoscopy*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }                        


                        // grouped7 contains Peg records, split into different residents
                        let grouped7 = {};
                        for (let i=0; i<Peg.length; i++) {
                            let p = Peg[i]['MCR_No'];
                            if (!grouped7[p]) { grouped7[p] = []; }
                            grouped7[p].push(Peg[i]);
                        }

                        CountPeg = Object.keys(grouped7).length

                        // for each resident in grouped7,
                        for (const key in grouped7) {
                            const value = grouped7[key] // the [?]array containing the resident's procedure info

                            TotalDonePeg = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDonePeg = TotalDonePeg + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDonePeg >= 5) { // if comply
                                NumCompliancePeg++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumCompliancePeg != 0) {
                            this.ChartConfig.datasets[0].data.push((NumCompliancePeg/CountPeg*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }                           


                        // grouped8 contains Gastro Variceal Hemo plus Ligation records, split into different residents
                        let grouped8 = {};
                        for (let i=0; i<GastroVaricealHemoPlusLigation.length; i++) {
                            let p = GastroVaricealHemoPlusLigation[i]['MCR_No'];
                            if (!grouped8[p]) { grouped8[p] = []; }
                            grouped8[p].push(GastroVaricealHemoPlusLigation[i]);
                        }

                        CountGastroVaricealHemoPlusLigation = Object.keys(grouped8).length

                        // for each resident in grouped8,
                        for (const key in grouped8) {
                            const value = grouped8[key] // the [?]array containing the resident's procedure info

                            TotalDoneGastroVaricealHemoPlusLigation = 0
                            GastroVaricealHemoPlusLigationAdditionalReqNum = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneGastroVaricealHemoPlusLigation = TotalDoneGastroVaricealHemoPlusLigation + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            for (let i = 0; i < value.length; i++) { // preparation for checking additional requirement
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                if (value[i]['Procedure_Name'] == "Gastroscopy with variceal hemostasis; active bleeding") {
                                    GastroVaricealHemoPlusLigationAdditionalReqNum = GastroVaricealHemoPlusLigationAdditionalReqNum + parseInt(procedure_obj['Performed'])
                                }
                            }

                            if (TotalDoneGastroVaricealHemoPlusLigation >= 20 && GastroVaricealHemoPlusLigationAdditionalReqNum >= 5) { // if comply
                                NumComplianceGastroVaricealHemoPlusLigation++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceGastroVaricealHemoPlusLigation != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceGastroVaricealHemoPlusLigation/CountGastroVaricealHemoPlusLigation*100).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((NumComplianceGastroVaricealHemoPlusLigation/CountGastroVaricealHemoPlusLigation*100).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((NumComplianceGastroVaricealHemoPlusLigation/CountGastroVaricealHemoPlusLigation*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))                            
                        }


                        // grouped9 contains Liver Biopsy records, split into different residents
                        let grouped9 = {};
                        for (let i=0; i<LiverBiopsy.length; i++) {
                            let p = LiverBiopsy[i]['MCR_No'];
                            if (!grouped9[p]) { grouped9[p] = []; }
                            grouped9[p].push(LiverBiopsy[i]);
                        }

                        CountLiverBiopsy = Object.keys(grouped9).length

                        // for each resident in grouped9,
                        for (const key in grouped9) {
                            const value = grouped9[key] // the [?]array containing the resident's procedure info

                            TotalDoneLiverBiopsy = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneLiverBiopsy = TotalDoneLiverBiopsy + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneLiverBiopsy >= 5) { // if comply
                                NumComplianceLiverBiopsy++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceLiverBiopsy != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceLiverBiopsy/CountLiverBiopsy*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }                          
                        

                        // grouped10 contains Esophageal Dilatation plus Luminal Stenting records, split into different residents
                        let grouped10 = {};
                        for (let i=0; i<EsophagealDilatationPlusLuminalStenting.length; i++) {
                            let p = EsophagealDilatationPlusLuminalStenting[i]['MCR_No'];
                            if (!grouped10[p]) { grouped10[p] = []; }
                            grouped10[p].push(EsophagealDilatationPlusLuminalStenting[i]);
                        }

                        CountEsophagealDilatationPlusLuminalStenting = Object.keys(grouped10).length

                        // for each resident in grouped10,
                        for (const key in grouped10) {
                            const value = grouped10[key] // the [?]array containing the resident's procedure info

                            TotalDoneEsophagealDilatationPlusLuminalStenting = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneEsophagealDilatationPlusLuminalStenting = TotalDoneEsophagealDilatationPlusLuminalStenting + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneEsophagealDilatationPlusLuminalStenting >= 5) { // if comply
                                NumComplianceEsophagealDilatationPlusLuminalStenting++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceEsophagealDilatationPlusLuminalStenting != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceEsophagealDilatationPlusLuminalStenting/CountEsophagealDilatationPlusLuminalStenting*100).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((NumComplianceEsophagealDilatationPlusLuminalStenting/CountEsophagealDilatationPlusLuminalStenting*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }                             
                        

                        // grouped11 contains Emr plus Esd records, split into different residents
                        let grouped11 = {};
                        for (let i=0; i<EmrPlusEsd.length; i++) {
                            let p = EmrPlusEsd[i]['MCR_No'];
                            if (!grouped11[p]) { grouped11[p] = []; }
                            grouped11[p].push(EmrPlusEsd[i]);
                        }

                        CountEmrPlusEsd = Object.keys(grouped11).length

                        // for each resident in grouped11,
                        for (const key in grouped11) {
                            const value = grouped11[key] // the [?]array containing the resident's procedure info

                            TotalDoneEmrPlusEsd = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneEmrPlusEsd = TotalDoneEmrPlusEsd + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneEmrPlusEsd >= 5) { // if comply
                                NumComplianceEmrPlusEsd++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceEmrPlusEsd != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceEmrPlusEsd/CountEmrPlusEsd*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }                             


                        // grouped12 contains Ercp records, split into different residents
                        let grouped12 = {};
                        for (let i=0; i<Ercp.length; i++) {
                            let p = Ercp[i]['MCR_No'];
                            if (!grouped12[p]) { grouped12[p] = []; }
                            grouped12[p].push(Ercp[i]);
                        }

                        CountErcp = Object.keys(grouped12).length

                        // for each resident in grouped12,
                        for (const key in grouped12) {
                            const value = grouped12[key] // the [?]array containing the resident's procedure info

                            TotalDoneErcp = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneErcp = TotalDoneErcp + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneErcp >= 5) { // if comply
                                NumComplianceErcp++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceErcp != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceErcp/CountErcp*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }                           


                        // grouped13 contains EndoscopicUltrasound records, split into different residents
                        let grouped13 = {};
                        for (let i=0; i<EndoscopicUltrasound.length; i++) {
                            let p = EndoscopicUltrasound[i]['MCR_No'];
                            if (!grouped13[p]) { grouped13[p] = []; }
                            grouped13[p].push(EndoscopicUltrasound[i]);
                        }

                        CountEndoscopicUltrasound = Object.keys(grouped13).length

                        // for each resident in grouped13,
                        for (const key in grouped13) {
                            const value = grouped13[key] // the [?]array containing the resident's procedure info

                            TotalDoneEndoscopicUltrasound = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneEndoscopicUltrasound = TotalDoneEndoscopicUltrasound + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneEndoscopicUltrasound >= 5) { // if comply
                                NumComplianceEndoscopicUltrasound++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceEndoscopicUltrasound != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceEndoscopicUltrasound/CountEndoscopicUltrasound*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        } 

                        
                        // grouped14 contains EsophagealMotility plus Ph records, split into different residents
                        let grouped14 = {};
                        for (let i=0; i<EsophagealMotilityPlusPh.length; i++) {
                            let p = EsophagealMotilityPlusPh[i]['MCR_No'];
                            if (!grouped14[p]) { grouped14[p] = []; }
                            grouped14[p].push(EsophagealMotilityPlusPh[i]);
                        }

                        CountEsophagealMotilityPlusPh = Object.keys(grouped14).length

                        // for each resident in grouped14,
                        for (const key in grouped14) {
                            const value = grouped14[key] // the [?]array containing the resident's procedure info

                            TotalDoneEsophagealMotilityPlusPh = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneEsophagealMotilityPlusPh = TotalDoneEsophagealMotilityPlusPh + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneEsophagealMotilityPlusPh >= 5) { // if comply
                                NumComplianceEsophagealMotilityPlusPh++
                            }

                            else { // prevents chart.js from inserting data into wrong position
                                nonCompliantResidentsGastro.push(value)
                            }

                        }

                        if (NumComplianceEsophagealMotilityPlusPh != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceEsophagealMotilityPlusPh/CountEsophagealMotilityPlusPh*100).toFixed(3))
                        }
                        else {
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        } 



                    }

                    // if user chose Renal Medicine 
                    else if (this.programme == "Renal Medicine") {
                        
                        const Renal = ["Insertion of non-tunneled haemodialysis catheter - Femoral (C)", "Insertion of non-tunneled haemodialysis catheter - Internal Jugular (C)", "Insertion of non-tunneled haemodialysis catheter - Femoral", "Insertion of non-tunneled haemodialysis catheter - Internal Jugular", "Native Kidney Biopsy (C)", "Transplant Kidney Biopsy (C)", "Native Kidney Biopsy", "Transplant Kidney Biopsy"]
                        this.ChartConfig.labels = Renal
                        this.options.title.text = "Procedure Log (Renal Programme)"

                        nonCompliantResidentsRenal = []

                        InsertionFemoralC = []
                        TotalDoneInsertionFemoralC = 0
                        CountInsertionFemoralC = 0
                        NumComplianceInsertionFemoralC = 0

                        InsertionJugularC = []
                        TotalDoneInsertionJugularC = 0
                        CountInsertionJugularC = 0
                        NumComplianceInsertionJugularC = 0

                        InsertionFemoral = []
                        TotalDoneInsertionFemoral = 0 
                        CountInsertionFemoral = 0
                        NumComplianceInsertionFemoral = 0

                        InsertionJugular = []
                        TotalDoneInsertionJugular = 0
                        CountInsertionJugular = 0 
                        NumComplianceInsertionJugular = 0

                        NativeKidneyBiopsyC = []
                        TotalDoneNativeKidneyBiopsyC = 0 
                        CountNativeKidneyBiopsyC = 0
                        NumComplianceNativeKidneyBiopsyC = 0

                        TransplantKidneyBiopsyC = []
                        TotalDoneTransplantKidneyBiopsyC = 0
                        CountTransplantKidneyBiopsyC = 0 
                        NumComplianceTransplantKidneyBiopsyC = 0

                        NativeKidneyBiopsy = []
                        TotalDoneNativeKidneyBiopsy = 0 
                        CountNativeKidneyBiopsy = 0 
                        NumComplianceNativeKidneyBiopsy = 0

                        TransplantKidneyBiopsy = []
                        TotalDoneTransplantKidneyBiopsy = 0
                        CountTransplantKidneyBiopsy = 0
                        NumComplianceTransplantKidneyBiopsy = 0

                        const groups = []

                        // go through each Renal log
                        for (let j = 0; j < renal_array.length; j++) {

                            renal_array[j] //each renal log
                            let procedure_name = renal_array[j]['Procedure_Name'] // each renal log's procedure name
                            // if name matches, push into respective procedure array
                            if (procedure_name == Renal[0]) {
                                InsertionFemoralC.push(renal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Renal[1]) {
                                InsertionJugularC.push(renal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Renal[2]) {
                                InsertionFemoral.push(renal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Renal[3]) {
                                InsertionJugular.push(renal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Renal[4]) {
                                NativeKidneyBiopsyC.push(renal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Renal[5]) {
                                TransplantKidneyBiopsyC.push(renal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Renal[6]) {
                                NativeKidneyBiopsy.push(renal_array[j])
                            }

                            else if (procedure_name == Renal[7]) {
                                TransplantKidneyBiopsy.push(renal_array[j])
                            }

                        }    
                        
                        // grouped1 contains InsertionFemoralC records, split into different residents
                        let grouped1 = {};
                        for (let i=0; i<InsertionFemoralC.length; i++) {
                            let p = InsertionFemoralC[i]['MCR_No'];
                            if (!grouped1[p]) { grouped1[p] = []; }
                            grouped1[p].push(InsertionFemoralC[i]);
                        }

                        CountInsertionFemoralC = Object.keys(grouped1).length

                        // for each resident in grouped1,
                        for (const key in grouped1) {
                            const value = grouped1[key] // the [?]array containing the resident's procedure info

                            TotalDoneInsertionFemoralC = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneInsertionFemoralC = TotalDoneInsertionFemoralC + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneInsertionFemoralC >= 5) { // if comply
                                NumComplianceInsertionFemoralC++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceInsertionFemoralC != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceInsertionFemoralC/CountInsertionFemoralC*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped2 contains InsertionJugularC records, split into different residents
                        let grouped2 = {};
                        for (let i=0; i<InsertionJugularC.length; i++) {
                            let p = InsertionJugularC[i]['MCR_No'];
                            if (!grouped2[p]) { grouped2[p] = []; }
                            grouped2[p].push(InsertionJugularC[i]);
                        }

                        CountInsertionJugularC = Object.keys(grouped2).length

                        // for each resident in grouped2,
                        for (const key in grouped2) {
                            const value = grouped2[key] // the [?]array containing the resident's procedure info

                            TotalDoneInsertionJugularC = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneInsertionJugularC = TotalDoneInsertionJugularC + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneInsertionJugularC >= 5) { // if comply
                                NumComplianceInsertionJugularC++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceInsertionJugularC != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceInsertionJugularC/CountInsertionJugularC*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped3 contains InsertionFemoral records, split into different residents
                        let grouped3 = {};
                        for (let i=0; i<InsertionFemoral.length; i++) {
                            let p = InsertionFemoral[i]['MCR_No'];
                            if (!grouped3[p]) { grouped3[p] = []; }
                            grouped3[p].push(InsertionFemoral[i]);
                        }

                        CountInsertionFemoral = Object.keys(grouped3).length

                        // for each resident in grouped3,
                        for (const key in grouped3) {
                            const value = grouped3[key] // the [?]array containing the resident's procedure info

                            TotalDoneInsertionFemoral = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneInsertionFemoral = TotalDoneInsertionFemoral + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneInsertionFemoral >= 5) { // if comply
                                NumComplianceInsertionFemoral++
                            }

                            else {
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceInsertionFemoral != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceInsertionFemoral/CountInsertionFemoral*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped4 contains InsertionJugular records, split into different residents
                        let grouped4 = {};
                        for (let i=0; i<InsertionJugular.length; i++) {
                            let p = InsertionJugular[i]['MCR_No'];
                            if (!grouped4[p]) { grouped4[p] = []; }
                            grouped4[p].push(InsertionJugular[i]);
                        }

                        CountInsertionJugular = Object.keys(grouped4).length

                        // for each resident in grouped4,
                        for (const key in grouped4) {
                            const value = grouped4[key] // the [?]array containing the resident's procedure info

                            TotalDoneInsertionJugular = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneInsertionJugular = TotalDoneInsertionJugular + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneInsertionJugular >= 5) { // if comply
                                NumComplianceInsertionJugular++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceInsertionJugular != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceInsertionJugular/CountInsertionJugular*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }

                        // grouped5 contains NativeKidneyBiopsyC records, split into different residents
                        let grouped5 = {};
                        for (let i=0; i<NativeKidneyBiopsyC.length; i++) {
                            let p = NativeKidneyBiopsyC[i]['MCR_No'];
                            if (!grouped5[p]) { grouped5[p] = []; }
                            grouped5[p].push(NativeKidneyBiopsyC[i]);
                        }

                        CountNativeKidneyBiopsyC = Object.keys(grouped5).length

                        // for each resident in grouped5,
                        for (const key in grouped5) {
                            const value = grouped5[key] // the [?]array containing the resident's procedure info

                            TotalDoneNativeKidneyBiopsyC = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneNativeKidneyBiopsyC = TotalDoneNativeKidneyBiopsyC + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneNativeKidneyBiopsyC >= 10) { // if comply
                                NumComplianceNativeKidneyBiopsyC++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceNativeKidneyBiopsyC != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceNativeKidneyBiopsyC/CountNativeKidneyBiopsyC*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }           


                        // grouped6 contains TransplantKidneyBiopsyC records, split into different residents
                        let grouped6 = {};
                        for (let i=0; i<TransplantKidneyBiopsyC.length; i++) {
                            let p = TransplantKidneyBiopsyC[i]['MCR_No'];
                            if (!grouped6[p]) { grouped6[p] = []; }
                            grouped6[p].push(TransplantKidneyBiopsyC[i]);
                        }

                        CountTransplantKidneyBiopsyC = Object.keys(grouped6).length

                        // for each resident in grouped6,
                        for (const key in grouped6) {
                            const value = grouped6[key] // the [?]array containing the resident's procedure info

                            TotalDoneTransplantKidneyBiopsyC = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneTransplantKidneyBiopsyC = TotalDoneTransplantKidneyBiopsyC + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneTransplantKidneyBiopsyC >= 3) { // if comply
                                NumComplianceTransplantKidneyBiopsyC++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceTransplantKidneyBiopsyC != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceTransplantKidneyBiopsyC/CountTransplantKidneyBiopsyC*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }         


                        // grouped7 contains NativeKidneyBiopsy records, split into different residents
                        let grouped7 = {};
                        for (let i=0; i<NativeKidneyBiopsy.length; i++) {
                            let p = NativeKidneyBiopsy[i]['MCR_No'];
                            if (!grouped7[p]) { grouped7[p] = []; }
                            grouped7[p].push(NativeKidneyBiopsy[i]);
                        }

                        CountNativeKidneyBiopsy = Object.keys(grouped7).length

                        // for each resident in grouped7,
                        for (const key in grouped7) {
                            const value = grouped7[key] // the [?]array containing the resident's procedure info

                            TotalDoneNativeKidneyBiopsy = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneNativeKidneyBiopsy = TotalDoneNativeKidneyBiopsy + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneNativeKidneyBiopsy >= 5) { // if comply
                                NumComplianceNativeKidneyBiopsy++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceNativeKidneyBiopsy != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceNativeKidneyBiopsy/CountNativeKidneyBiopsy*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }  


                        // grouped8 contains TransplantKidneyBiopsy records, split into different residents
                        let grouped8 = {};
                        for (let i=0; i<TransplantKidneyBiopsy.length; i++) {
                            let p = TransplantKidneyBiopsy[i]['MCR_No'];
                            if (!grouped8[p]) { grouped8[p] = []; }
                            grouped8[p].push(TransplantKidneyBiopsy[i]);
                        }

                        CountTransplantKidneyBiopsy = Object.keys(grouped8).length

                        // for each resident in grouped8,
                        for (const key in grouped8) {
                            const value = grouped8[key] // the [?]array containing the resident's procedure info

                            TotalDoneTransplantKidneyBiopsy = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneTransplantKidneyBiopsy = TotalDoneTransplantKidneyBiopsy + parseInt(procedure_obj['Performed']) // total done for specific resident
                            }

                            if (TotalDoneTransplantKidneyBiopsy >= 2) { // if comply
                                NumComplianceTransplantKidneyBiopsy++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceTransplantKidneyBiopsy != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceTransplantKidneyBiopsy/CountTransplantKidneyBiopsy*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }  

                    }

                    // if user chose Internal Medicine 
                    else if (this.programme == "Internal Medicine") {

                        const Internal = ["Abdominal Tap", "Arterial Line Placement", "Central Line Placement", "Thoracentesis / Chest tube", "Lumbar Puncture", "Endotracheal Intubation", "Ventilator Management", "Arthrocentesis", "Hemodialysis Catheter Insertion", "ABG", "Vene", "IV Plug", "Ecg"]
                        this.ChartConfig.labels = Internal
                        this.options.title.text = "Procedure Log (Internal Programme)"

                        nonCompliantResidentsInternal = []

                        AbdominalTap = []
                        TotalDoneAbdominalTap = 0 
                        CountAbdominalTap = 0 
                        NumComplianceAbdominalTap = 0

                        ArterialLinePlacement = []
                        TotalDoneArterialLinePlacement = 0 
                        CountArterialLinePlacement = 0 
                        NumComplianceArterialLinePlacement = 0

                        CentralLinePlacement = []
                        TotalDoneCentralLinePlacement = 0 
                        CountCentralLinePlacement = 0 
                        NumComplianceCentralLinePlacement = 0

                        ThoracentesisChestTube = []
                        TotalDoneThoracentesisChestTube = 0 
                        CountThoracentesisChestTube = 0 
                        NumComplianceThoracentesisChestTube = 0

                        LumbarPuncture = []
                        TotalDoneLumbarPuncture = 0 
                        CountLumbarPuncture = 0 
                        NumComplianceLumbarPuncture = 0

                        EndotrachealIntubation = []
                        TotalDoneEndotrachealIntubation = 0 
                        CountEndotrachealIntubation = 0 
                        NumComplianceEndotrachealIntubation = 0

                        VentilatorManagement = []
                        TotalDoneVentilatorManagement = 0 
                        CountVentilatorManagement = 0 
                        NumComplianceVentilatorManagement = 0

                        Arthrocentesis = []
                        TotalDoneArthrocentesis = 0 
                        CountArthrocentesis = 0 
                        NumComplianceArthrocentesis = 0

                        HemodialysisCatheterInsertion = []
                        TotalDoneHemodialysisCatheterInsertion = 0
                        CountHemodialysisCatheterInsertion = 0 
                        NumComplianceHemodialysisCatheterInsertion = 0

                        Abg = []
                        TotalDoneAbg = 0 
                        CountAbg = 0 
                        NumComplianceAbg = 0

                        Vene = []
                        TotalDoneVene = 0 
                        CountVene = 0 
                        NumComplianceVene = 0

                        IVPlug = []
                        TotalDoneIVPlug = 0 
                        CountIVPlug = 0 
                        NumComplianceIVPlug = 0

                        Ecg = []
                        TotalDoneEcg = 0 
                        CountEcg = 0 
                        NumComplianceEcg = 0

                        const groups = []

                        // go through each Internal log
                        for (let j = 0; j < internal_array.length; j++) {

                            internal_array[j] //each internal log
                            let procedure_name = internal_array[j]['Procedure_Name'] // each internal log's procedure name
                            // if name matches, push into respective procedure array
                            if (procedure_name == Internal[0]) {
                                AbdominalTap.push(internal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Internal[1]) {
                                ArterialLinePlacement.push(internal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Internal[2]) {
                                CentralLinePlacement.push(internal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Internal[3]) {
                                ThoracentesisChestTube.push(internal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Internal[4]) {
                                LumbarPuncture.push(internal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Internal[5]) {
                                EndotrachealIntubation.push(internal_array[j]) // could have multiple residents in this array
                            }

                            else if (procedure_name == Internal[6]) {
                                VentilatorManagement.push(internal_array[j])
                            }

                            else if (procedure_name == Internal[7]) {
                                Arthrocentesis.push(internal_array[j])
                            }

                            else if (procedure_name == Internal[8]) {
                                HemodialysisCatheterInsertion.push(internal_array[j])
                            }

                            else if (procedure_name == Internal[9]) {
                                Abg.push(internal_array[j])
                            }

                            else if (procedure_name == Internal[10]) {
                                Vene.push(internal_array[j])
                            }

                            else if (procedure_name == Internal[11]) {
                                IVPlug.push(internal_array[j])
                            }

                            else if (procedure_name == Internal[12]) {
                                Ecg.push(internal_array[j])
                            }

                        }    

                        // grouped1 contains AbdominalTap records, split into different residents
                        let grouped1 = {};
                        for (let i=0; i<AbdominalTap.length; i++) {
                            let p = AbdominalTap[i]['MCR_No'];
                            if (!grouped1[p]) { grouped1[p] = []; }
                            grouped1[p].push(AbdominalTap[i]);
                        }

                        CountAbdominalTap = Object.keys(grouped1).length

                        // for each resident in grouped1,
                        for (const key in grouped1) {
                            const value = grouped1[key] // the [?]array containing the resident's procedure info

                            TotalDoneAbdominalTap = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneAbdominalTap = TotalDoneAbdominalTap + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneAbdominalTap >= 3) { // if comply
                                NumComplianceAbdominalTap++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceAbdominalTap != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceAbdominalTap/CountAbdominalTap*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped2 contains ArterialLinePlacement records, split into different residents
                        let grouped2 = {};
                        for (let i=0; i<ArterialLinePlacement.length; i++) {
                            let p = ArterialLinePlacement[i]['MCR_No'];
                            if (!grouped2[p]) { grouped2[p] = []; }
                            grouped2[p].push(ArterialLinePlacement[i]);
                        }

                        CountArterialLinePlacement = Object.keys(grouped2).length

                        // for each resident in grouped2,
                        for (const key in grouped2) {
                            const value = grouped2[key] // the [?]array containing the resident's procedure info

                            TotalDoneArterialLinePlacement = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneArterialLinePlacement = TotalDoneArterialLinePlacement + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneArterialLinePlacement >= 5) { // if comply
                                NumComplianceArterialLinePlacement++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceArterialLinePlacement != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceArterialLinePlacement/CountArterialLinePlacement*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped3 contains CentralLinePlacement records, split into different residents
                        let grouped3 = {};
                        for (let i=0; i<CentralLinePlacement.length; i++) {
                            let p = CentralLinePlacement[i]['MCR_No'];
                            if (!grouped3[p]) { grouped3[p] = []; }
                            grouped3[p].push(CentralLinePlacement[i]);
                        }

                        CountCentralLinePlacement = Object.keys(grouped3).length

                        // for each resident in grouped3,
                        for (const key in grouped3) {
                            const value = grouped3[key] // the [?]array containing the resident's procedure info

                            TotalDoneCentralLinePlacement = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneCentralLinePlacement = TotalDoneCentralLinePlacement + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneCentralLinePlacement >= 5) { // if comply
                                NumComplianceCentralLinePlacement++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceCentralLinePlacement != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceCentralLinePlacement/CountCentralLinePlacement*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped4 contains ThoracentesisChestTube records, split into different residents
                        let grouped4 = {};
                        for (let i=0; i<ThoracentesisChestTube.length; i++) {
                            let p = ThoracentesisChestTube[i]['MCR_No'];
                            if (!grouped4[p]) { grouped4[p] = []; }
                            grouped4[p].push(ThoracentesisChestTube[i]);
                        }

                        CountThoracentesisChestTube = Object.keys(grouped4).length

                        // for each resident in grouped4,
                        for (const key in grouped4) {
                            const value = grouped4[key] // the [?]array containing the resident's procedure info

                            TotalDoneThoracentesisChestTube = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneThoracentesisChestTube = TotalDoneThoracentesisChestTube + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneThoracentesisChestTube >= 3) { // if comply
                                NumComplianceThoracentesisChestTube++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceThoracentesisChestTube != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceThoracentesisChestTube/CountThoracentesisChestTube*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped5 contains LumbarPuncture records, split into different residents
                        let grouped5 = {};
                        for (let i=0; i<LumbarPuncture.length; i++) {
                            let p = LumbarPuncture[i]['MCR_No'];
                            if (!grouped5[p]) { grouped5[p] = []; }
                            grouped5[p].push(LumbarPuncture[i]);
                        }

                        CountLumbarPuncture = Object.keys(grouped5).length

                        // for each resident in grouped5,
                        for (const key in grouped5) {
                            const value = grouped5[key] // the [?]array containing the resident's procedure info

                            TotalDoneLumbarPuncture = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneLumbarPuncture = TotalDoneLumbarPuncture + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneLumbarPuncture >= 5) { // if comply
                                NumComplianceLumbarPuncture++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceLumbarPuncture != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceLumbarPuncture/CountLumbarPuncture*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped6 contains EndotrachealIntubation records, split into different residents
                        let grouped6 = {};
                        for (let i=0; i<EndotrachealIntubation.length; i++) {
                            let p = EndotrachealIntubation[i]['MCR_No'];
                            if (!grouped6[p]) { grouped6[p] = []; }
                            grouped6[p].push(EndotrachealIntubation[i]);
                        }

                        CountEndotrachealIntubation = Object.keys(grouped6).length

                        // for each resident in grouped6,
                        for (const key in grouped6) {
                            const value = grouped6[key] // the [?]array containing the resident's procedure info

                            TotalDoneEndotrachealIntubation = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneEndotrachealIntubation = TotalDoneEndotrachealIntubation + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneEndotrachealIntubation >= 5) { // if comply
                                NumComplianceEndotrachealIntubation++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceEndotrachealIntubation != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceEndotrachealIntubation/CountEndotrachealIntubation*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped7 contains VentilatorManagement records, split into different residents
                        let grouped7 = {};
                        for (let i=0; i<VentilatorManagement.length; i++) {
                            let p = VentilatorManagement[i]['MCR_No'];
                            if (!grouped7[p]) { grouped7[p] = []; }
                            grouped7[p].push(VentilatorManagement[i]);
                        }

                        CountVentilatorManagement = Object.keys(grouped7).length

                        // for each resident in grouped7,
                        for (const key in grouped7) {
                            const value = grouped7[key] // the [?]array containing the resident's procedure info

                            TotalDoneVentilatorManagement = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneVentilatorManagement = TotalDoneVentilatorManagement + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneVentilatorManagement >= 5) { // if comply
                                NumComplianceVentilatorManagement++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceVentilatorManagement != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceVentilatorManagement/CountVentilatorManagement*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped8 contains Arthrocentesis records, split into different residents
                        let grouped8 = {};
                        for (let i=0; i<Arthrocentesis.length; i++) {
                            let p = Arthrocentesis[i]['MCR_No'];
                            if (!grouped8[p]) { grouped8[p] = []; }
                            grouped8[p].push(Arthrocentesis[i]);
                        }

                        CountArthrocentesis = Object.keys(grouped8).length

                        // for each resident in grouped8,
                        for (const key in grouped8) {
                            const value = grouped8[key] // the [?]array containing the resident's procedure info

                            TotalDoneArthrocentesis = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneArthrocentesis = TotalDoneArthrocentesis + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneArthrocentesis >= 2) { // if comply
                                NumComplianceArthrocentesis++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceArthrocentesis != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceArthrocentesis/CountArthrocentesis*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped9 contains HemodialysisCatheterInsertion records, split into different residents
                        let grouped9 = {};
                        for (let i=0; i<HemodialysisCatheterInsertion.length; i++) {
                            let p = HemodialysisCatheterInsertion[i]['MCR_No'];
                            if (!grouped9[p]) { grouped9[p] = []; }
                            grouped9[p].push(HemodialysisCatheterInsertion[i]);
                        }

                        CountHemodialysisCatheterInsertion = Object.keys(grouped9).length

                        // for each resident in grouped9,
                        for (const key in grouped9) {
                            const value = grouped9[key] // the [?]array containing the resident's procedure info

                            TotalDoneHemodialysisCatheterInsertion = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneHemodialysisCatheterInsertion = TotalDoneHemodialysisCatheterInsertion + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneHemodialysisCatheterInsertion >= 3) { // if comply
                                NumComplianceHemodialysisCatheterInsertion++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceHemodialysisCatheterInsertion != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceHemodialysisCatheterInsertion/CountHemodialysisCatheterInsertion*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped10 contains Abg records, split into different residents
                        let grouped10 = {};
                        for (let i=0; i<Abg.length; i++) {
                            let p = Abg[i]['MCR_No'];
                            if (!grouped10[p]) { grouped10[p] = []; }
                            grouped10[p].push(Abg[i]);
                        }

                        CountAbg = Object.keys(grouped10).length

                        // for each resident in grouped10,
                        for (const key in grouped10) {
                            const value = grouped10[key] // the [?]array containing the resident's procedure info

                            TotalDoneAbg = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneAbg = TotalDoneAbg + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneAbg >= 1) { // if comply
                                NumComplianceAbg++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceAbg != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceAbg/CountAbg*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped11 contains Vene records, split into different residents
                        let grouped11 = {};
                        for (let i=0; i<Vene.length; i++) {
                            let p = Vene[i]['MCR_No'];
                            if (!grouped11[p]) { grouped11[p] = []; }
                            grouped11[p].push(Vene[i]);
                        }

                        CountVene = Object.keys(grouped11).length

                        // for each resident in grouped11,
                        for (const key in grouped11) {
                            const value = grouped11[key] // the [?]array containing the resident's procedure info

                            TotalDoneVene = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneVene = TotalDoneVene + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneVene >= 1) { // if comply
                                NumComplianceVene++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceVene != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceVene/CountVene*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped12 contains IVPlug records, split into different residents
                        let grouped12 = {};
                        for (let i=0; i<IVPlug.length; i++) {
                            let p = IVPlug[i]['MCR_No'];
                            if (!grouped12[p]) { grouped12[p] = []; }
                            grouped12[p].push(IVPlug[i]);
                        }

                        CountIVPlug = Object.keys(grouped12).length

                        // for each resident in grouped12,
                        for (const key in grouped12) {
                            const value = grouped12[key] // the [?]array containing the resident's procedure info

                            TotalDoneIVPlug = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneIVPlug = TotalDoneIVPlug + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneIVPlug >= 1) { // if comply
                                NumComplianceIVPlug++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceIVPlug != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceIVPlug/CountIVPlug*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }


                        // grouped13 contains Ecg records, split into different residents
                        let grouped13 = {};
                        for (let i=0; i<Ecg.length; i++) {
                            let p = Ecg[i]['MCR_No'];
                            if (!grouped13[p]) { grouped13[p] = []; }
                            grouped13[p].push(Ecg[i]);
                        }

                        CountEcg = Object.keys(grouped13).length

                        // for each resident in grouped13,
                        for (const key in grouped13) {
                            const value = grouped13[key] // the [?]array containing the resident's procedure info

                            TotalDoneEcg = 0

                            for (let i = 0; i < value.length; i++) {
                                let procedure_obj = value[i] // the object containing the resident's procedure info
                                TotalDoneEcg = TotalDoneEcg + parseInt(procedure_obj['Verified']) // total done for specific resident
                            }

                            if (TotalDoneEcg >= 1) { // if comply
                                NumComplianceEcg++
                            }

                            else { 
                                nonCompliantResidentsRenal.push(value)
                            }

                        }

                        if (NumComplianceEcg != 0) {
                            this.ChartConfig.datasets[0].data.push((NumComplianceEcg/CountEcg*100).toFixed(3))
                        }
                        else { // prevents chart.js from inserting data into wrong position
                            this.ChartConfig.datasets[0].data.push((0).toFixed(3))
                        }

                    }

                }
            }
        });
        
    </script>
</body>

</html>